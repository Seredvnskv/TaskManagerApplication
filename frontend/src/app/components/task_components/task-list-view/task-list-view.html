<section class="task-board">
  <div class="board-menu">
    <div class="task-filters">
      <h3 class="filter-title">Filters</h3>

      <div class="filter-group">
        <label class="filter-label">Search</label>
        <input
          type="text"
          class="filter-input"
          placeholder="Search tasks..."
          [(ngModel)]="filters.searchText"
          (ngModelChange)="applyFilters()"
        />
      </div>

      <div class="filter-group">
        <label class="filter-label">Status</label>
        <div class="checkbox-group">
          <label class="checkbox-label">
            <input
              type="checkbox"
              [(ngModel)]="filters.showToDo"
              (change)="applyFilters()"
            />
            <span class="checkbox-text">To Do</span>
          </label>
          <label class="checkbox-label">
            <input
              type="checkbox"
              [(ngModel)]="filters.showInProgress"
              (change)="applyFilters()"
            />
            <span class="checkbox-text">In Progress</span>
          </label>
          <label class="checkbox-label">
            <input
              type="checkbox"
              [(ngModel)]="filters.showDone"
              (change)="applyFilters()"
            />
            <span class="checkbox-text">Done</span>
          </label>
        </div>
      </div>

      <div class="filter-group">
        <label class="filter-label">Created By</label>
        <select
          class="filter-select"
          [(ngModel)]="filters.user"
          (change)="applyFilters()"
        >
          <option value="">All Users</option>
          @for (user of users; track user) {
            <option [value]="user.username">{{ user.username }}</option>
          }
        </select>
      </div>

      <div class="filter-group">
        <label class="filter-label">Due Date From</label>
        <input
          type="date"
          class="filter-input"
          [(ngModel)]="filters.dateFrom"
          (ngModelChange)="applyFilters()"
        />
      </div>

      <div class="filter-group">
        <label class="filter-label">Due Date To</label>
        <input
          type="date"
          class="filter-input"
          [(ngModel)]="filters.dateTo"
          (ngModelChange)="applyFilters()"
        />
      </div>

      <button class="btn-reset" (click)="resetFilters()">
        Reset Filters
      </button>

      <button class="btn-add-task" [routerLink]="['/tasks', 'add']">
        Add Task
      </button>

      <button class="btn-export-tasks" (click)="exportTasks()">
        Export Tasks
      </button>
    </div>
  </div>

  <div class="task-column">
    <div class="column-header todo-header">
      <h2>To Do</h2>
      <span class="task-count">{{ getTasksByStatus(TaskStatus.TODO).length }}</span>
    </div>
    <div class="task-container">
      @if (getTasksByStatus(TaskStatus.TODO).length === 0) {
        <div class="empty-state">
          No tasks to show
        </div>
      }
      @else {
        @for (task of getTasksByStatus(TaskStatus.TODO); track task.id) {
          <a class="task-card" [routerLink]="['/tasks', task.id]">
            <h3 class="task-title">{{ task.title }}</h3>
            <p class="task-description">{{ task.description }}</p>
            <div class="task-meta">
              <div class="task-users-info">
                <span class="task-creator">Created by: {{ task.createdBy }}</span>
                <span class="task-assignees">Assigned to: {{ task.assignedUsers.join(", ")}}</span>
              </div>
              <div class="task-dates-info">
                <span class="task-due-date">Due: {{ task.dueDate | date:'short' }}</span>
                <span class="task-update-date">Updated: {{ task.updatedAt | date:'short' }}</span>
              </div>
            </div>
          </a>
        }
      }
    </div>
  </div>

  <div class="task-column">
    <div class="column-header in-progress-header">
      <h2>In Progress</h2>
      <span class="task-count">{{ getTasksByStatus(TaskStatus.IN_PROGRESS).length }}</span>
    </div>
    <div class="task-container">
      @if (getTasksByStatus(TaskStatus.IN_PROGRESS).length === 0) {
        <div class="empty-state">
          No tasks to show
        </div>
      }
      @else {
        @for (task of getTasksByStatus(TaskStatus.IN_PROGRESS); track task.id) {
          <a class="task-card" [routerLink]="['/tasks', task.id]">
            <h3 class="task-title">{{ task.title }}</h3>
            <p class="task-description">{{ task.description }}</p>
            <div class="task-meta">
              <div class="task-users-info">
                <span class="task-creator">Created by: {{ task.createdBy }}</span>
                <span class="task-assignees">Assigned to: {{ task.assignedUsers.join(", ")}}</span>
              </div>
              <div class="task-dates-info">
                <span class="task-due-date">Due: {{ task.dueDate | date:'short' }}</span>
                <span class="task-update-date">Updated: {{ task.updatedAt | date:'short' }}</span>
              </div>
            </div>
          </a>
        }
      }
    </div>
  </div>

  <div class="task-column">
    <div class="column-header done-header">
      <h2>Done</h2>
      <span class="task-count">{{ getTasksByStatus(TaskStatus.DONE).length }}</span>
    </div>
    <div class="task-container">
      @if (getTasksByStatus(TaskStatus.DONE).length === 0) {
        <div class="empty-state">
          No tasks to show
        </div>
      }
      @else {
        @for (task of getTasksByStatus(TaskStatus.DONE); track task.id) {
          <a class="task-card" [routerLink]="['/tasks', task.id]">
            <h3 class="task-title">{{ task.title }}</h3>
            <p class="task-description">{{ task.description }}</p>
            <div class="task-meta">
              <div class="task-users-info">
                <span class="task-creator">Created by: {{ task.createdBy }}</span>
                <span class="task-assignees">Assigned to: {{ task.assignedUsers.join(", ")}}</span>
              </div>
              <div class="task-dates-info">
                <span class="task-due-date">Due: {{ task.dueDate | date:'short' }}</span>
                <span class="task-update-date">Updated: {{ task.updatedAt | date:'short' }}</span>
              </div>
            </div>
          </a>
        }
      }
    </div>
  </div>
</section>
